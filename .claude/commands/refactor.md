現在のファイルをリファクタリングしてください。

以下の観点で改善してください：
- コードの重複を削除
- 関数を適切なサイズに分割
- 変数名をわかりやすくする
- TypeScriptの型を適切に使用
- コメントを追加（必要に応じて）

変更内容と理由を説明してください。
