# 通貨換算ツール

リアルタイムの為替レートを使用して、主要通貨間で金額を換算できるWebアプリケーションです。

## 機能概要

- **リアルタイム為替レート**: ExchangeRate-APIから最新の為替レートを取得
- **主要12通貨対応**: USD, EUR, JPY, GBP, CNY, KRW, AUD, CAD, CHF, HKD, SGD, INR
- **一括換算**: 1回の検索で複数通貨への換算結果を表示
- **美しいUI**: グラデーションとアニメーションを活用したモダンなデザイン
- **レスポンシブ対応**: デスクトップ、タブレット、スマートフォンに最適化
- **自動キャッシング**: 1時間ごとにレートを更新（不要なAPI呼び出しを削減）

## 技術スタック

- **フレームワーク**: Next.js 16.0.1 (App Router)
- **言語**: TypeScript
- **スタイリング**: Tailwind CSS
- **API**: ExchangeRate-API (無料、APIキー不要)

## セットアップ

### 1. 依存関係のインストール

```bash
cd example1
npm install
```

### 2. 開発サーバーの起動

```bash
npm run dev
```

ブラウザで `http://localhost:3000/currency` にアクセスしてください。

## 使い方

1. **金額を入力**: 換算したい金額を入力フィールドに入力
2. **基準通貨を選択**: ドロップダウンから換算元の通貨を選択
3. **換算ボタンをクリック**: 「換算する」ボタンをクリックして結果を表示

### 換算例

- 100 USD → 各主要通貨への換算額を表示
- 10,000 JPY → 各主要通貨への換算額を表示

## 対応通貨一覧

| 通貨コード | 通貨名 | 記号 |
|-----------|--------|------|
| USD | アメリカドル | $ |
| EUR | ユーロ | € |
| JPY | 日本円 | ¥ |
| GBP | イギリスポンド | £ |
| CNY | 中国元 | ¥ |
| KRW | 韓国ウォン | ₩ |
| AUD | オーストラリアドル | A$ |
| CAD | カナダドル | C$ |
| CHF | スイスフラン | Fr |
| HKD | 香港ドル | HK$ |
| SGD | シンガポールドル | S$ |
| INR | インドルピー | ₹ |

## APIについて

### ExchangeRate-API

このアプリは [ExchangeRate-API](https://www.exchangerate-api.com/) の無料版を使用しています。

**特徴:**
- APIキー不要
- 1時間ごとに為替レート更新
- 信頼性の高いデータソース
- レート制限: 無料版は月1,500リクエストまで

**APIエンドポイント:**
```
https://open.exchangerate-api.com/v6/latest/{基準通貨コード}
```

**レスポンス例:**
```json
{
  "result": "success",
  "provider": "https://www.exchangerate-api.com",
  "time_last_update_utc": "Sat, 01 Jan 2025 00:00:01 +0000",
  "base_code": "USD",
  "rates": {
    "JPY": 149.82,
    "EUR": 0.92,
    "GBP": 0.79,
    ...
  }
}
```

## ファイル構成

```
example1/
├── src/
│   ├── app/
│   │   ├── currency/
│   │   │   └── page.tsx          # 通貨換算のフロントエンドページ
│   │   └── api/
│   │       └── currency/
│   │           └── route.ts       # 通貨換算APIエンドポイント
│   └── types/
│       └── currency.ts            # 型定義（API、通貨情報）
└── docs/
    └── currency-app/
        └── README.md              # このファイル
```

## 主要コンポーネント

### 1. フロントエンドページ (`src/app/currency/page.tsx`)

- **入力フォーム**: 金額と基準通貨の選択
- **換算結果テーブル**: 枠線付きの見やすい表形式で表示
  - 通貨情報（コード、名称、国旗）
  - 為替レート（1基準通貨あたり）
  - 換算額（通貨記号付き）
- **エラーハンドリング**: APIエラーやバリデーションエラーの表示
- **使い方ガイド**: 初回表示時の操作説明

### 2. APIルート (`src/app/api/currency/route.ts`)

**パラメータ:**
- `from`: 基準通貨コード (必須)
- `amount`: 換算する金額 (必須)
- `to`: ターゲット通貨のカンマ区切りリスト (オプション、デフォルトは全主要通貨)

**バリデーション:**
- 基準通貨が空でないか
- 金額が有効な数値かつ0より大きいか

**レスポンス:**
```typescript
{
  success: boolean;
  data?: {
    baseCurrency: string;
    baseAmount: number;
    conversions: Array<{
      currency: string;
      rate: number;
      amount: number;
      symbol: string;
      name: string;
    }>;
    lastUpdated: string;
  };
  error?: string;
}
```

### 3. 型定義 (`src/types/currency.ts`)

- `ExchangeRateApiResponse`: 外部APIのレスポンス型
- `CurrencyConversion`: 換算結果の型
- `CurrencyApiResponse`: 内部APIのレスポンス型
- `CurrencyInfo`: 通貨情報（コード、名称、記号、国旗）
- `MAJOR_CURRENCIES`: 対応通貨のマスターリスト
- `getCurrencyInfo()`: 通貨コードから情報を取得するヘルパー関数

## パフォーマンス最適化

### 1. サーバーサイドキャッシング

Next.jsの `fetch` APIに `revalidate` オプションを設定：

```typescript
const response = await fetch(apiUrl, {
  next: { revalidate: 3600 }, // 1時間キャッシュ
});
```

- 同じ基準通貨への複数リクエストでAPIコールを削減
- 為替レートは頻繁に変動しないため、1時間のキャッシュで十分

### 2. 効率的なデータフェッチング

- クライアント側で必要な時のみAPIを呼び出し
- フォーム送信時のみデータ取得（リアルタイム更新は不要）

## UI/UXの特徴

### デザインシステム

- **カラースキーム**: 紫→ピンク→赤のグラデーション
- **レイアウト**: 2カラムレイアウト（左：入力フォーム、右：結果表示）
- **タイポグラフィ**: 明瞭な階層構造と読みやすいフォントサイズ

### インタラクティブ要素

1. **換算ボタン**
   - グラデーション背景
   - ホバー時の光沢効果（左から右へスライド）
   - アイコンの回転＆拡大アニメーション
   - 下部アクセントラインの表示

2. **結果テーブル**
   - ストライプ行（白/グレー交互）
   - ホバー時のハイライト（薄紫色）
   - 明確な枠線で視認性向上
   - グラデーションヘッダー

3. **レスポンシブ対応**
   - モバイル: 縦積みレイアウト
   - タブレット/デスクトップ: 2カラムレイアウト
   - テーブルの横スクロール対応

## エラーハンドリング

### バリデーションエラー

- 基準通貨が選択されていない
- 金額が入力されていない、または0以下

### APIエラー

- 為替レート取得失敗
- 無効な通貨コード
- ネットワークエラー

すべてのエラーは美しいエラー画面で表示されます：
- 赤→ピンクのグラデーション背景
- 警告アイコン
- わかりやすいエラーメッセージ

## トラブルシューティング

### 問題: 「為替レートの取得に失敗しました」エラーが表示される

**原因:**
- インターネット接続の問題
- ExchangeRate-APIのサービス停止
- 月間APIリクエスト制限超過（無料版: 1,500リクエスト/月）

**解決策:**
1. インターネット接続を確認
2. 数分待ってから再試行
3. ブラウザのキャッシュをクリア (Ctrl+Shift+R)
4. 開発者ツールのネットワークタブでAPIレスポンスを確認

### 問題: 特定の通貨が表示されない

**原因:**
- ExchangeRate-APIがその通貨をサポートしていない
- 通貨コードのスペルミス

**解決策:**
- `MAJOR_CURRENCIES` リストを確認
- [ExchangeRate-API ドキュメント](https://www.exchangerate-api.com/docs/free) でサポート通貨を確認

### 問題: 古い為替レートが表示される

**原因:**
- ブラウザまたはNext.jsのキャッシュ

**解決策:**
1. ページをハードリフレッシュ (Ctrl+Shift+R)
2. 1時間待つ（自動キャッシュ更新）
3. 開発環境で `.next` フォルダを削除して再起動

## 今後の拡張案

1. **通貨追加**: より多くの通貨をサポート
2. **履歴機能**: 過去の換算履歴を保存
3. **比較機能**: 複数の為替レート提供元を比較
4. **グラフ表示**: 為替レートの推移をチャートで表示
5. **お気に入り通貨**: よく使う通貨をピン留め
6. **オフライン対応**: Service Workerで最後の為替レートをキャッシュ
7. **カスタム通貨ペア**: 特定の通貨ペアのみを表示

## セキュリティ

- **APIキー不要**: 公開APIを使用しているためセキュリティリスクなし
- **入力バリデーション**: サーバー側で厳格な入力検証
- **XSS対策**: Reactの自動エスケープ機能により保護
- **HTTPS**: 本番環境ではHTTPS通信を推奨

## ライセンス

このプロジェクトはトレーニング目的で作成されています。

## 関連リンク

- [ExchangeRate-API Documentation](https://www.exchangerate-api.com/docs/free)
- [Next.js Documentation](https://nextjs.org/docs)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)
